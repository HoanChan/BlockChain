# Blockmemo - Nháº­t kÃ½ sáº£n pháº©m (Truy xuáº¥t nguá»“n gá»‘c)

## Giá»›i thiá»‡u
Dá»± Ã¡n nÃ y lÃ  má»™t bÃ i táº­p lá»›n káº¿t thÃºc há»c pháº§n "Blockchain vÃ  á»¨ng dá»¥ng" táº¡i Äáº¡i há»c Nha Trang. Chá»§ Ä‘á» cá»§a dá»± Ã¡n lÃ  "Blockmemo - Nháº­t kÃ½ sáº£n pháº©m", nháº±m tÃ¬m hiá»ƒu vÃ  á»©ng dá»¥ng cÃ´ng nghá»‡ blockchain Ä‘á»ƒ truy xuáº¥t nguá»“n gá»‘c sáº£n pháº©m.

## ThÃ´ng tin chung
- **Há»c viÃªn**: LÃª HoÃ n ChÃ¢n
- **MÃ£ sá»‘ há»c viÃªn**: 64CH032
- **Lá»›p**: CNTT2022
- **Há»c pháº§n**: Blockchain vÃ  á»©ng dá»¥ng
- **Giáº£ng viÃªn**: TS. Pháº¡m VÄƒn Nam
- **Thá»i gian**: ThÃ¡ng 8/2024

## Äáº·t váº¥n Ä‘á»
CÃ´ng nghá»‡ Blockchain Ä‘ang trá»Ÿ thÃ nh má»™t cÃ´ng nghá»‡ tiÃªn tiáº¿n trong cuá»™c CÃ¡ch máº¡ng cÃ´ng nghiá»‡p 4.0 vÃ  Ä‘Æ°á»£c á»©ng dá»¥ng vÃ o nhiá»u lÄ©nh vá»±c. Tuy nhiÃªn, trong ngÃ nh nÃ´ng nghiá»‡p á»Ÿ Viá»‡t Nam, viá»‡c truy xuáº¥t nguá»“n gá»‘c hÃ ng hÃ³a váº«n lÃ  má»™t váº¥n Ä‘á» khÃ³ khÄƒn. Dá»± Ã¡n "Blockmemo - Nháº­t kÃ½ sáº£n pháº©m" nháº±m nghiÃªn cá»©u vÃ  phÃ¡t triá»ƒn á»©ng dá»¥ng blockchain Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y.

## BÃ i toÃ¡n kiá»ƒm soÃ¡t nguá»“n gá»‘c sáº£n pháº©m
### Äá»‹nh nghÄ©a vÃ  Ã½ nghÄ©a
Truy xuáº¥t nguá»“n gá»‘c sáº£n pháº©m lÃ  quÃ¡ trÃ¬nh theo dÃµi vÃ  ghi láº¡i lá»‹ch sá»­ cá»§a sáº£n pháº©m tá»« nguá»“n gá»‘c Ä‘áº¿n ngÆ°á»i tiÃªu dÃ¹ng cuá»‘i cÃ¹ng.

### CÃ¡c váº¥n Ä‘á» cáº§n giáº£i quyáº¿t
- Äáº£m báº£o tÃ­nh minh báº¡ch
- Chá»‘ng gian láº­n
- NÃ¢ng cao niá»m tin cá»§a ngÆ°á»i tiÃªu dÃ¹ng

### CÃ´ng nghá»‡ blockchain trong kiá»ƒm soÃ¡t nguá»“n gá»‘c sáº£n pháº©m
Blockchain cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ lÆ°u trá»¯ vÃ  xÃ¡c minh thÃ´ng tin vá» nguá»“n gá»‘c sáº£n pháº©m, Ä‘áº£m báº£o ráº±ng thÃ´ng tin nÃ y khÃ´ng thá»ƒ bá»‹ thay Ä‘á»•i.

### Lá»£i Ã­ch cá»§a kiá»ƒm soÃ¡t nguá»“n gá»‘c sáº£n pháº©m
- NÃ¢ng cao cháº¥t lÆ°á»£ng sáº£n pháº©m
- TÄƒng cÆ°á»ng niá»m tin cá»§a ngÆ°á»i tiÃªu dÃ¹ng
- Giáº£m thiá»ƒu rá»§i ro gian láº­n

## á»¨ng dá»¥ng Blockchain trong truy xuáº¥t nguá»“n gá»‘c
Blockchain cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o ra má»™t há»‡ thá»‘ng truy xuáº¥t nguá»“n gá»‘c sáº£n pháº©m hiá»‡u quáº£ vÃ  minh báº¡ch, giÃºp nÃ¢ng cao niá»m tin cá»§a ngÆ°á»i tiÃªu dÃ¹ng vÃ  cáº£i thiá»‡n cháº¥t lÆ°á»£ng sáº£n pháº©m.


## CÃ¡c bÆ°á»›c thá»±c hiá»‡n cá»¥ thá»ƒ:
- Khá»Ÿi Ä‘á»™ng `CodeSpace` (ÄÃ£ cáº¥u hÃ¬nh sáºµn viá»‡c cÃ i Ä‘áº·t `Node.js`)
- CÃ¡c gÃ³i thÆ° viá»‡n cáº§n thiáº¿t cho dá»± Ã¡n Ä‘Æ°á»£c cáº¥u hÃ¬nh táº¡i file `package.json` cÅ©ng Ä‘Æ°á»£c tá»± Ä‘á»™ng cÃ i Ä‘áº·t cÃ¹ng vá»›i viá»‡c khá»Ÿi táº¡o `codespace` nhá» lá»‡nh `npm install` trong file `.devcontainer/devcontainer.json`. Náº¿u cáº§n cáº­p nháº­t cÃ¡c goi thÆ° viá»‡n má»›i thÃ¬ nhá»› cháº¡y lá»‡nh `npm install` trÃªn terminal
- GÃµ lá»‡nh: `npx truffle -v` trÃªn terminal Ä‘á»ƒ xem cÃ¡c thÃ´ng tin vá» phiÃªn báº£n cá»§a `Truffle`, `Ganache`, `Solidity`, `Node` vÃ  `Web3.js`
- GÃµ lá»‡nh `npx truffle init` trÃªn terminal Ä‘á»ƒ báº¯t Ä‘áº§u thiáº¿t láº­p cÃ¡c file, thÆ° má»¥c cÆ¡ báº£n cho dá»± Ã¡n
- GÃµ lá»‡nh: `npx ganache-cli` trÃªn terminal Ä‘á»ƒ khá»Ÿi Ä‘á»™ng Ganache vÃ  xem cÃ¡c thÃ´ng tin vá» network vÃ  accounts
- Copy cÃ¡c thÃ´ng tin vá» network cá»§a Ganache vÃ o file cáº¥u hÃ¬nh `truffle-config.js`

```javascript
module.exports = {
  networks: {
     development: {
     host: "127.0.0.1",     // Localhost (default: none)
     port: 8545,            // Standard Ethereum port (default: none)
     network_id: "*",       // Any network (default: none)
    }
  }
}
```

- GÃµ lá»‡nh `npx truffle compile` trÃªn terminal Ä‘á»ƒ biÃªn dá»‹ch cÃ¡c file `.sol` trong thÆ° má»¥c `contracts`, káº¿t quáº£ sáº½ lÃ  cÃ¡c file tÆ°Æ¡ng á»©ng vá»›i tÃªn contracts vÃ  Ä‘Æ°á»£c lÆ°u trong thÆ° má»¥c `build\contracts`
- Táº¡o file `index.js` chá»©a thÃ´ng tin mÃ¡y chá»§ node.js

```javascript
const express = require("express");
const path = require("path");
const app = express();

app.get("/", (req, res) => {
    res.sendFile(path.join(__dirname + "/src/main.html"));
})

const server = app.listen(5000);
const portNumber = server.address().port;
console.log(`port is open on ${portNumber}`);
```

- Táº¡o file `main.html` trong thÆ° má»¥c `src` vÃ  cÃ¡c file khÃ¡c Ä‘á»ƒ dá»±ng giao diá»‡n á»©ng dá»¥ng. 
- Náº¿u cáº§n sá»­ dá»¥ng web3 thÃ¬ thÃªm thÆ° viá»‡n vÃ o:

```html
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.2.7-rc.0/web3.min.js"></script>
```
- ThÃªm nÃºt vÃ o HTML:

```html
<button id="conn" onclick="Conn2BC()">Káº¿t ná»‘i Ä‘áº¿n máº¡ng blockchain</button>
```

- Viáº¿t mÃ£ js Ä‘á»ƒ káº¿t ná»‘i tá»›i máº¡ng BlockChain:

```javascript
const Conn2BC = async () => {
        if (typeof window.ethereum !== 'undefined') {
            try {
                const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
                account = accounts[0];
                const ABI = [ ... ];
                const Address = "...";
                window.web3 = new Web3(window.ethereum);
                window.contract = new window.web3.eth.Contract(ABI, Address);
                document.getElementById("conn").innerHTML = "Káº¿t ná»‘i Ä‘áº¿n máº¡ng blockchain: thÃ nh cÃ´ng";
            } catch (error) {
                document.getElementById("conn").innerHTML = "Lá»—i khi káº¿t ná»‘i Ä‘áº¿n MetaMask.";
                console.error(error);
            }
        } else {
            document.getElementById("conn").innerHTML = "Vui lÃ²ng cÃ i Ä‘áº·t MetaMask.";
        }
    }
```

`ABI` Ä‘Æ°á»£c copy tá»« file `.json` khi compile báº±ng `Truffle` vÃ  `Address` lÃ  Ä‘á»‹a chá»‰ cá»§a tÃ i khoáº£n vÃ­ (Public key)
- Äá»ƒ `web3` hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c cáº§n cÃ i Ä‘áº·t `MetaMask` ğŸ¡’ vÃ o pháº§n cÃ i Ä‘áº·t ğŸ¡’ thÃªm mÃ¡y chá»§ `Ganache` á»Ÿ má»¥c `Networks` ğŸ¡’ thÃªm tÃ i khoáº£n vÃ­ (1 trong cÃ¡c tÃ i khoáº£n - Private key Ä‘Æ°á»£c `Ganache` táº¡o sáºµn khi khá»Ÿi Ä‘á»™ng mÃ¡y chá»§)
- GÃµ lá»‡nh: `npm run start` trÃªn terminal hoáº·c nháº¥n `Ctrl + Shift + B` Ä‘á»ƒ cháº¡y á»©ng dá»¥ng.